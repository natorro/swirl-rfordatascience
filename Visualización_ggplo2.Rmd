#**Visualización con ggplot2**

###*Introducción* 

En ésta lección te enseñaremos a visualizar datos usando ggplot2. ¿Qué es ggplot2?, ggplot2 es un sistema que implementa una gramática gráfica, esto lo hace ser un sistema coherente para describir y construir graficas  con mayor facilidad.

Para iniciar el curso, requerimos el uso de la libreria tidyverse, la cual se puede inicializar con el siguiente codigo:
>library(tidyverse)

Iniciaremos por plantear una cuestión: ¿los autos con grandes engranes usan mas combustible que autos con engranes pequeños?

Para resolver esta pregunta, iniciaremos por imprimir los contenidos de un "data frame" correspondiente a las observaciones recolectadas por la agencia de protección del medio ambiente de U.S.A. en 38 modelos de autos.

>Data frame: Colección rectangular de variables en las columnas, y observaciones en los campos. 

Imprime el data frame ingresando el comando:
>mpg

Para obtener una descripción sobre los datos, variables, e información relevante para la interpretación correcta del data frame puedes usar ?mpg

Usar un ? antes de cualquier función o variable te permite obtener información importante para su comprensión, implementación o interpretación.

Ahora bien, si se quiere visualizar la información en un gráfico se puede usar la siguiente estructura básica de codigo:

>ggplot(data = <DATOS>) + <GEOM_FUNCIÓN>(mapping = aes(<MAPPEADOS>))

La cual, al reemplazar la información en mayusculas de la siguiente forma: 
```{r}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy))
```
Donde: 
* ggplot: función que inicializa el conjunto de datos a usar
* mpg: conjunto de datos a usar, en este caso un data frame
* geom_point: función que genera una sección de un producto cartesiano por puntos
* aes: contracción del termino aesthetics, los cuales son indicaciónes de gráficos insertados en el producto cartesiano, donde se definen variables y como se desea iterpretar visualmente, por ejemplo <x = displ, y = hwy>, donde se indica que dentro de los vectores x y y se insertaran los valores de las variables displ y hwy correspondientes a mpg


###*Mapeos Estéticos*

Al diagrama de dispersión binomial generado por el comando anterior, puede agregarle una tercera variable, como clase, asignándolo a una estética.

>*Estética: propiedad visual de los objetos en la gráfica*

La estetica incluye cosas como el tamaño, la forma o el color de tus datos en la gráfica; para hacer referencia a la estetica propiamente dicha utilizaremos la referencia nivel.

La función junta cada uno de los mapeos estéticos usados por capas y los pasa a el argumento de mapeo de capas. Incluso las variables x y y son esteticas al ser localizaciones que se pueden mapear como propiedades visuales sobre los datos.

Para poder realizar un mapeo mucho más sencillo de la clase de tus datos, asignaremos la variable  color al código anterior, quedando como se muestra a continuación:

```{r}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, color = class))
```

Para asignar una estética a una variable, asocie el nombre de la estetica a la variable dentro del siguiente comando:

```{r}
aes().ggplot2
```

Automaticamente asignara un unico nivel a la estética(sólo en ésta parte un unico color) para cada valor único de la variable, un proceso conocido como:

```{r}
scaling.ggplot2
```

Este proceso tambien te agregará una leyenda que explica que niveles coresponden a cada valor.

También se puede hacer un mapeo por el tamaño de la clase, agregando la siguiente variable:

```{r}
size = class
```

En este caso,el tamaño exacto de cada punto revelará su clase, quedando el código de la siguiente manera:

```{r}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, size = class))
```

__*Este comando es sólo para mapear un desorden variable, si se mapea una estética en orden, nos lanzará una advertencia*__

Para mapear la estética ordenada de los datos que tenemos en la gráfica, podemos hacerlo mapeando la clase de la estetica alpha, que controla la transparencia de los puntos o la forma de los puntos.

Los siguientes códigos son un ejemplo para mapear la estética alpha, tanto en transparencia como en forma.

__ Estética alpha donde se controla la transparencia de los puntos__

```{r}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, alpha = class))
```

__Estética alpha donde se controla la forma de los puntos__

```{r}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, shape = class))
```
alpha solo usa 6 figuras en una sola implementación, y por default los grupos adicionales no seran graficados cuando se usa.

Las estéticas tambien se pueden aplicar a todo el conjunto, sin que contengan información sobre la variable, y solo cambien la apariencia del gráfico, definindolas fuera de la funcion aes():

```{r}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy), color = "blue")
```

Aplica para:
*Cambios de color
*Tamaño de un punto en mm
*la figura de un punto

Una vez que mapeas la estética, ggplot2 selecciona una escala razonable para mapearlo, y construye las leyendas que explican el mapeado entre valores y niveles. Para x y y crea un axis que marca y etiqueta.

